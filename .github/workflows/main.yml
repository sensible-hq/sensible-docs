name: Linting and link checking jobs
on:
  push:
    branches: [ main ]
jobs:
  check-links:
    runs-on: ubuntu-latest
    steps:
      # get the changelogs and save locally so you can check those links
      - name: Checkout 🛎️
        uses: actions/checkout@v2 
      - name: Set up Python 🐍
        uses: actions/setup-python@v2
        with:
          python-version: '3.x'
          architecture: 'x64'
      - name: Install dependencies 🔧 
        run: cd ./scripts/check_links/ && python -m pip install requests
      - name: fetch changelog markdown and save as HTML 🏗  
        env:
          README_API_KEY: ${{ secrets.README_API_KEY}}
        run: python ./scripts/check_links/get_readme_changelog.py 
        
      # check the links for everything including changelogs
      - name: Checkout 🛎️
        uses: actions/checkout@v2 
      - name: Set up Ruby 💎
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: '2.7'
          bundler-cache: true
      - name: Install dependencies 🔧
        run: cd ./scripts/check_links/ && bundle install
      - name: Build HTML frm markdown and check links 🏗  
        run: ruby ./scripts/check_links/check_links.rb
  prose:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Vale
        uses: errata-ai/vale-action@master
        with:
          # Optional
          styles: |
            https://github.com/errata-ai/Google/releases/latest/download/Google.zip
            https://github.com/errata-ai/write-good/releases/latest/download/write-good.zip

          # Optional
          # config: https://raw.githubusercontent.com/errata-ai/vale/master/.vale.ini

          # Optional
          files: __onlyModified #all
        env:
          # Required
          GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}

    
        
 